#### 构建技术

##### 前提概要

个人认为是处于编译构建阶段的操作。整个打包流程就是：编译-->DEX-->打包-->签名和对齐。
[img](img_打包流程图.png)
第一步就是编译阶段，在这个阶段，对于代码来说就 是.java文件 -> .class文件 -> .dex文件的转换过程。更深入可能需要了解一些JVM相关知识。这篇主
要是了解构建相关的。在android中主要就是gradle了。分以下点来了解。

* gradle
* transform

##### gradle
一、gradle是什么?  
简单来说gradle就是一个构建工具，与ant是一样的。它使用的是groovy语言。

二、groovy语法   
想深入学习gradle，学习groovy语法是不可缺少的。对于开发来说，至少掌握了一种语言，那么学习其他语言来也是比较轻松的。不多做描述。

三、gradle的执行流程  
流程一般分为：初始化 --> 配置 --> 执行。

四、task    
gradle在配置阶段，其实就是配置Project对象，而Project对象则是由一个或多个task组成。可以说task是gradle执行的最小单元。

五、plugin(插件)    
插件是类似一个工具，也类似一个第三方库。需要引入到项目中。这样做的好处是更加省事方便，高效，毕竟能重复利用。重点要掌握自定义插件。
<https://blog.csdn.net/qq_20798591/article/details/107061673>



##### transform     
前面提到plugin插件是用来定制一个功能，功能上像一个工具包，接入方式上像第三方库。但是有时候想在插件中完成对项目内容的修改，这就需要
在gradle构建过程中，拿到源文件才行。这时，就要用到transform功能了。transform是Android官方提供给开发者在项目构建阶段(.class --> 
.dex转换期间)用来修改.class文件的一套标准API，即把输入的.class文件转变成目标字节码文件。经典的应用有字节码插桩、代码注入(DI)等。学习
transform主要就是学习它API。

<https://www.jianshu.com/p/cf90c557b866>


实际应用:
##### 1、全埋点
涉及比较广，其实就是全局事件监听，页面停留时间等等一系列的东西，用到的技术无非apt、apo、插桩等等

##### 2、APT(注释处理器)
APT(Annotation Processing Tool的简称)，可以在代码编译期解析注解，并且生成新的java文件，减少手动的代码输入。现在有很多主流库都用上了APT，
比如Dagger2,EventBus3,黄油刀等等。

##### 3、AOP(切面编程)
参考资料：<https://www.jianshu.com/p/9fb07b2596f7>

##### 4、ASM(插桩)

##### 5、Hook  