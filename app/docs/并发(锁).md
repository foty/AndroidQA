
#### 并发与锁

<https://www.cnblogs.com/hustzzl/p/9343797.html>  
1.锁的分类有几种：
* 乐观锁/悲观锁
* 独享锁/共享锁
* 互斥锁/读写锁
* 可重入锁
* 公平锁/非公平锁
* 分段锁
* 偏向锁/轻量级锁/重量级锁
* 自旋锁

>1.1 乐观锁与悲观锁  
乐观锁： 如同字面意思，就是很乐观。每次访问时默认没有其他人修改，所以不会加锁。只是在更新时判断是否已经被更新过。常用的实现方式有“版本号机制”与CAS。乐观
锁适用于读取频率高的场合，可以提高吞吐量。   
悲观锁：每次访问都是按照是最坏的情况来处理，也就是加上锁。这样其他人只能先拿到锁才能去访问数据。悲观锁适合写入操作频繁的场景。如 synchronized。

1.1.1 “版本号机制”  
为一段数据增加一个版本号，每次修改数据并且更新版本号。在数据修改更新前，会先读取到版本号；提交修改时，只有更新前读取的版本号与现阶段数据最新的版本号相等时
才能提交成功。

1.1.2 CAS
(Compare And Swap)比较并交换的缩写。CAS机制包含3个操作对象。1是需要更新的位置；2是预期值；3是新值。只有当需要更新的位置上的值与预期值相等时，才会将需要
更新位置上的值设置为新值。否则全部失败。

>1.2 独享锁与共享锁  
独享锁： 是指该锁一次只能被一个线程锁持有。共享锁：是指该锁能被多个线程锁持有。独享锁与共享锁是通过AQS来实现，通过不同的实现方法，来实现独享或共享。像
synchronized 就是一个独享锁。

1.2.1 AQS  
AbstractQueuedSynchronized 抽象队列式同步器的缩写。

2.volatile、happens 、before、 lost wake up
3.AQS(AbstractQueuedSynchronized)  抽象队列式同步器。
4.synchronized
5.CAS